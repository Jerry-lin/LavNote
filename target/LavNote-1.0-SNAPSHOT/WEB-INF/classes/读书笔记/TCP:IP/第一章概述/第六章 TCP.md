# 				运输层

运输层是进程和进程之间的通讯，有两个重要的功能是复用和分用。

运输层提供两种不同的传输方式：UDP和TCP

使用两种不同协议的应用如下：

![image-20180425092427777](/Users/youyujie/Documents/读书笔记/TCP:IP/第一章概述/使用TCP和UDP的应用.png)

## 6.1用户数据报协议UDP

1.UDP无连接

2.UDP使用尽最大努力交付

3.UDP是面向报文的

4.UDP没有拥塞控制

5.UDP支持一对多、多对一、多对多的交互通讯

6.UDP首部开销小

UDP首部只有8字节，包含源端口，目的端口，长度，校验和

## 6.2TCP协议

1,面向连接的

2.点对点

3.可靠交付

4.全双工

5.面向字节流

## 6.3可靠传输的工作原理

理想的传输条件有两个特点：

1.传输信道不产生差错

2.不管发送方以多块的书读发送数据，接收房总是来得及处理收到的数据

### 6.3.1停止等待协议

停止等待就是每发完一个分组就停止发送，等待对方的确认。在收到确认后，再发送下一个分组。

**1.无差错情况**

![image-20180509185746368](/Users/youyujie/Documents/读书笔记/TCP:IP/第一章概述/停止等待协议.png)

**2.出现差错**

发送者只要超过一定时间没有收到确认，就认为刚才发送的分组丢失了，因而重传前面发送的分组，这就叫超时重传。

1.发送方必须暂时保留一发送的副本。

2.分组和确认都必须进行编号

3.超时计时器设置要合理一些。

**3.确认丢失和确认迟到**

在接收方收到A重传的分组后，需要采取以下两个动作。

第一，丢弃这个重复的分组

第二，向A发送确认

上述这些可靠传输协议称为自动重传ARQ

**B.信道利用率**

为了提高信道利用率，发送方可以不使用低效率的停止等待协议，而是采用流水线传输。

### 6.3.2连续ARQ协议

接收方一般次啊用累计确认的方式。

## 5.5TCP报文段的首部格式

TCP报文分为数据和首部。

首部是20个字节

![image-20180509192922987](/Users/youyujie/Documents/读书笔记/TCP:IP/第一章概述/TCP首部格式.png)

首部各个字段意思

1.源端口和目的端口，各占2个字节

2.序号，占4个字节

3，确认号，4个字节，期望收到对方下一个报文段的第一个数据字节的序号。

![image-20180509202012626](/Users/youyujie/Documents/读书笔记/TCP:IP/第一章概述/TCP.png)